import easyocr
import cv2
from PIL import Image
import numpy as np

# Load image and preprocess
image_path = "4405D4F6-A0C7-48A6-9838-A5E49CC59C8E.jpeg"  # Your file
img = cv2.imread(image_path)

# Convert to grayscale
gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)

# Apply adaptive threshold to handle box lines and improve text separation
thresh = cv2.adaptiveThreshold(
    gray, 255, cv2.ADAPTIVE_THRESH_MEAN_C, cv2.THRESH_BINARY_INV, 15, 10
)

# Optional: remove noise and small box lines
kernel = cv2.getStructuringElement(cv2.MORPH_RECT, (1, 1))
cleaned = cv2.morphologyEx(thresh, cv2.MORPH_OPEN, kernel)

# Invert back for OCR (white text on black background doesn't work well)
processed_img = cv2.bitwise_not(cleaned)

# Convert for EasyOCR
reader = easyocr.Reader(['en'])
results = reader.readtext(processed_img, detail=0)

# Join and display results
final_text = "\n".join(results)
print("ðŸ“„ Final Extracted Text:")
print(final_text)
